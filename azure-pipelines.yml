trigger:
- main

pool:infraassignment_agentpool


stages:
  - stage: build
    jobs:
      - job: initvalidateplan
        displayName: initvalidateplan
        steps:
        - task: TerraformTask@5
          inputs:
            provider: 'azurerm'
            command: 'init'
            backendServiceArm: 'infra_serviceconnecton'
            backendAzureRmStorageAccountName: 'todostoragesantosh'
            backendAzureRmContainerName: 'todocontainer'
            backendAzureRmKey: 'dev.terraform.tfstate'
        - task: TerraformTask@5
          inputs:
            provider: 'azurerm'
            command: 'validate'
        - task: TerraformTask@5
          inputs:
            provider: 'azurerm'
            command: 'plan'
            environmentServiceNameAzureRM: 'infra_serviceconnecton'